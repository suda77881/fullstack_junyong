-- #1. 테이블구조확인
desc emp;
desc dept;

show user;       -- 실행) 현재줄 선택하고 ctrl + enter
select  table_name   from  user_tables;    -- 사용할수 있는 테이블 확인

-- #2. 전체테이블 조회
select * from emp;

-- #3. 열조회
select empno, ename  from  emp;
select ename, job    from  emp;

-- #4. 중복제거 (distinct)
select  distinct  job   from  emp;
select  all       job   from  emp;

-- #5. 연산 및 별칭
desc  emp;

--  3달치 급여
select  ename "유저" , sal as "월급"  , sal+sal+sal   as  "3달치 월급"       from emp;

-- #6. 정렬
select   ename, sal   from     emp   order by sal asc ;    -- asc는 오름차순
select   ename, sal   from     emp   order by sal  desc;   -- desc는 내림차순



--  조건에 맞는 데이터 조회
--  #1. where      
--  #2. 비교연산자 : (같다) = , (다르다) != , <>  ,  ^=   
--  #3. 논리연산자 : AND / BETWEEN      AND  (범위지정) , OR / IN , NOT    
--  #4. like     : 패턴검색
--  #5. null 처리 : null 여부확인 
--  #6. 집합연산자 : union (중복제거하고 합집합) ,  union all (중복 포함하고 합집합) , minus(차집합) , intersect(교집합)


-- #1. 전체데이터 조회 ( emp 테이블에서 )
select * from emp;

-- #2. where  조건조회
select * from emp  where  empno =7839;   -- 같다 =
select * from emp  where  empno!=7839;   -- 다르다 !=
select * from emp  where  empno<>7839;   -- 다르다 <>
select * from emp  where  empno^=7839;   -- 다르다 ^=

select * from emp where ename='KING';

select * from emp  where  empno=7839 and  ename='KING';  -- and 두가지다 조건이 맞아야함.
select * from emp  where  empno=7839 and  ename='SCOTT'; -- x
select * from emp  where  empno=7839 or   ename='SCOTT'; -- or 둘중에 하나

select * from emp  where  sal*12 = 36000;
select * from emp  where  sal >= 3000;

select * from emp where  ename >='S';
select * from emp where  ename <='SOR';

select * from emp  where deptno>=20  and  deptno<=30;   -- >= , <=
select * from emp  where deptno  between  20  and   30; -- between and는 이상과 이하

select * from emp  where deptno=10  or  deptno=30; 
select * from emp  where deptno  in(10,30);

select * from emp  where ename =     'KING';  -- 이름이 알때
select * from emp  where ename LIKE  'A%';    -- 이름이 A로 시작할때
select * from emp  where ename LIKE  '%A%';   -- 이름이 A가 중간
select * from emp  where ename LIKE  '%G';    -- G로 끝나는
select * from emp  where ename LIKE  '_I%';   -- _(첫글자) 두번째글자가 I

select * from emp  where comm =  null;  --  X  null (데이터 없어 - 상태)
select * from emp  where comm is null; 
select * from emp  where comm is not null; 


-- #7. 집합연산자 : union (중복제거하고 합집합) ,  union all (중복 포함하고 합집합) , minus(차집합) , intersect(교집합)
-------------------------------------
SELECT * 
FROM   EMP
WHERE  DEPTNO=10
-------------------------------------
UNION
-------------------------------------
SELECT * 
FROM   EMP
WHERE  DEPTNO=10;
-------------------------------------

-- #8. union all (중복 포함하고 합집합)
-------------------------------------
SELECT * 
FROM   EMP
WHERE  DEPTNO=10
-------------------------------------
UNION ALL
-------------------------------------
SELECT * 
FROM   EMP
WHERE  DEPTNO=10;
-------------------------------------


-- #9. Minus( 차집합 )
-------------------------------------
SELECT * 
FROM   EMP 
-------------------------------------
MINUS
-------------------------------------
SELECT * 
FROM   EMP
WHERE  DEPTNO=20;
-------------------------------------


-- #10. INTERSECT  (교집합)
-------------------------------------
SELECT * 
FROM   EMP 
-------------------------------------
INTERSECT
-------------------------------------
SELECT * 
FROM   EMP
WHERE  DEPTNO=20;
-------------------------------------

-------------------------------------------------------------------------------------
-- 003_select_function.sql
-- 1. 문자열
-- 2. 숫자
-- 3. 날짜
-- 4. 변환
-- 5. 조건
-------------------------------------------------------------------------------------
-- 003_select_function.sql
-- 1. 문자열
-- 1-1. upper  대문자, lower 소문자, initcap 대소문자 변환
-- 1-2. length 문자열길이
-- 1-3. substr 부분문자열 ,   instr  위치문자열
-- 1-4. replace 바꾸기 ,  lpad, rpad 채우기
-- 1-5. trim , ltrim, rtrim  공백빼기
-- 1-6. concat 문자열연결

-- #1. 대소문자
select   ename, upper(ename), lower(ename), initcap(ename)   
from     emp;

-- #2. 문자열길이
select ename, length(ename), lengthb(ename) , '킹' , length('킹') , lengthb('킹')
from emp;

-- #3. substr(문자열, 어디서부터 ,몇개 ) 부분문자열 , instr  위치문자열
select ename, substr(ename, 1,2) ,  substr(ename, 1,3) , substr(ename, 2,2) , substr (ename, 3,2)  from emp;
select     substr('oracle' , -1) , substr('oracle' , -3)                , substr('oracle' , -3,2) from dual;
--           e 뒤에서1번부터끝까지      cle 뒤에서부터 세번째부터 끝까지         cl 뒤에 세번째부터  2개
--   -붙이면 끝에서 부터 계산
select     substr('oracle' , -2) ,  substr('oracle' , -2,1)  from dual;  -- le  l

select    instr('oracle' , 'a') from dual;  -- o(1) r(2) a(3) c(4) l(5) e(6)
select   ename, instr(ename, 'A') from emp; -- 있으면 위치, 없으면 0

-- #4. replace(어떤문자열을, 찾아서, 바꾸기) 바꾸기 ,  lpad, rpad 채우기
select  replace( '010-1234-5678' ,'-',' ') from dual;
select  lpad('oracle' , 10 , '#') , rpad('oracle' , 10 , '#') from dual;  -- ㅣ (left채우기)   r( right채우기)

-- #5. trim , ltrim, rtrim  공백빼기
select  trim(' *oracle* ') , ltrim(' *oracle* ') , rtrim(' *oracle* ')  
from dual;

-- #6. concat 문자열연결- 두개의 문자열만 연결가능
select   concat('Hello ' , 'Oracle') from     dual;
select   concat(  concat('Hello ' , 'Oracle')  , '★') from     dual;  -- concat 중첩해서 사용

select  'Hello '  || 'Oracle ' || '♥'  from dual;

-------------------------------------------------------------------------------------
-- 003_select_function.sql
-- 1. 문자열
-- 2. 숫자   :   round / trunc(반올림/버림) , ceil( 올림 ) , floor ( 내림) , mod  (나머지)
-- 3. 날짜   :   sysdate (시스템날짜), add_months(몇달뒤에) , next_day, last_day
-- 4. 변환   :   to_char (날짜형식변환), to_date
-- 5. 조건   :   nvl, nvl2 ( null) , decode, case ( 조건분기 ) 
-------------------------------------------------------------------------------------
-- 2. 숫자   :   round / trunc(반올림/버림) , ceil( 올림 ) , floor ( 내림) , mod  (나머지)
select   round(  1234.5678   )   , round(  1234.5678  , 2  ) , trunc(  1234.5678  , 2  ) , ceil(1.1) , floor(4.8)  , mod(10,3)
from dual;     -- 1235              1234.57                       1234.56                      2          4            1

-------------------------------------------------------------------------------------
-- 3. 날짜   :   sysdate (시스템날짜,시간반환), add_months(몇달뒤에) , next_day, last_day
select   SYSDATE  , add_months(  SYSDATE, 1) ,    months_between(  '25-12-1'  , '24-12-1' )
from     dual;

select  NEXT_DAY(SYSDATE,  '월요일')  "다음주 월요일" ,   LAST_DAY(SYSDATE)  "해당월의 마지막 날짜"
from dual;

select  NEXT_DAY(SYSDATE,  1)  "다음주 월요일" ,   LAST_DAY(SYSDATE)  "해당월의 마지막 날짜"
from dual;

-------------------------------------------------------------------------------------
-- 4. 변환   :   to_char (날짜형식변환), to_date
--                날짜를     문자로                         문자를         날짜로
select   TO_CHAR( SYSDATE , 'YYYY-MM-DD' ) ,  TO_DATE(  '2025-10-16' , 'YYYY-MM-DD'  )
from     dual;

--        숫자1234를 문자열로 변환한 다음 +1   ( 자동변환해서 오류가 안날수 있음. )
select    TO_CHAR(1234)               + 1       ,   TO_NUMBER('5678') + 1 
from     dual;

select    TO_CHAR('일이삼사')               + 1   ,   TO_NUMBER('5678') + 1   -- 오류
from     dual;

select           "1234"   + 1  , 1+"1234"       --  자료형이 안맞으면 오류남.
from     dual;

-------------------------------------------------------------------------------------
-- 5. 조건   :   nvl, nvl2 ( null) , decode, case ( 조건분기 ) 

select   nvl(  NULL , '대체값' )             from      dual; -- null 이면 대체값    / null  value  logic( replacement )
select   nvl(          comm  , '입력안됨.')   from     emp;   -- X 오류
select   nvl(  to_char(comm) , '입력안됨.')   from     emp;   -- O 자료형을 맞춰야함.

select  nvl2( NULL, 'A' , 'B'  )     from dual;    -- null 일때 b, 아니면 a
-----
select  nvl2( mgr,          mgr , '--'  )     from emp;   -- 오류나는이유는? 
select  nvl2( mgr, to_char(mgr) , '상위관리자 x'  )     from emp;   -- 해결방안    ( nvl, nvl2  null일때 값 반환 / 자료형맞추기)
-----
select decode( deptno, 10 , '부서10' , 20, '부서20' , 30, '부서30' )
from   emp;
-----
select case  
            when deptno=10 then  '부서10'  
            when deptno=20 then  '부서20'   
            when deptno=30 then  '부서30'  
            else                 '부서x'
       end
from   emp;
-----
select case deptno 
            when 10 then  '부서10'  
            when 20 then  '부서20'   
            when 30 then  '부서30'  
            else          '부서x'
       end
from   emp;


-- 1 
select * from emp;

-- 2. 집계 sum ,  max , min ,  avg , count
select  sum(sal)   from   emp;  -- 급여의 합계
select  sum(comm)  from   emp;  -- null 값이 있어도 계산가능

--       14줄  1줄
-- select sal, sum(sal), max(sal), min(sal), avg(sal), count(sal) from emp; -- error
select   sum(sal) 합, max(sal) 최대, min(sal) 최소,  round( avg(sal) ,2) 평균 , count(sal) 갯수 from emp;


-- 3. group by
--select  --5
--from    --1
--where   --2  (전체필터링)
--group by  --3 그룹핑
--having    --4 그룹핑안에서 조건( 그룹핑 후 필터링)
--order by; --6
-- 부서[별] 급여의 합
select   deptno , sum(sal)
from     emp
group by deptno;






